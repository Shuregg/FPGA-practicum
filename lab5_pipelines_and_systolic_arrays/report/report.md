# Lab 05. Pipelines and Systolic arrays

## Ð¡Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ ÑÑ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ñ‚Ð°ÐºÑ‚Ð¾Ð²Ð¾Ð¹ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñ‹ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð° Ð±ÐµÐ· ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð° Ñ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹. ÐšÐ°ÐºÐ¾Ð¹ Ð¸Ð· Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð¾Ð² Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ?
Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð´Ð»Ñ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð²Ð¾Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð² 5-ÑƒÑŽ ÑÑ‚ÐµÐ¿ÐµÐ½ÑŒ:
![alt text](image.png)
ÐŸÑƒÑ‚Ñ‘Ð¼ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° Ñ‚Ð°ÐºÑ‚Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ¸Ð³Ð½Ð°Ð»Ð° ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÐµÐ³Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ (Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð¾ 1 Ð½Ñ) Ñ ÑƒÑÐ»Ð¾Ð²Ð¸ÐµÐ¼ `WNS > 0`. ÐŸÐµÑ€Ð¸Ð¾Ð´ Ñ€Ð°Ð²ÐµÐ½ 22 Ð½Ñ. Ð—Ð½Ð°Ñ Ð²Ñ€ÐµÐ¼Ñ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° T_c Ð¸ WNS Ð¼Ð¾Ð¶ÐµÐ¼ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½ÑƒÑŽ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñƒ Ð´Ð»Ñ ÑÑ‚Ð¾Ð¹ ÑÑ…ÐµÐ¼Ñ‹ Ð¿Ð¾ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ðµ: `ð…_ð¦ðšð± = ðŸ / (ð“_ðœ - WNS)`
Ð˜Ñ‚Ð¾Ð³Ð¾ `F_max = 1 / ((22 - 0.378) * 10^-9) â‰ˆ 46.2492 MHz`

ÐÐ½Ð°Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ð¾ Ð´Ð»Ñ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð²Ð¾Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð² ÑÑ‚ÐµÐ¿ÐµÐ½ÑŒ:
![alt text](image-1.png)
`T_c = 8 ns`, `WNS = 0.220 ns`, `F_max â‰ˆ 128.5350 MHz`

>ÐžÑ‡ÐµÐ²Ð¸Ð´Ð½Ð¾, ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð½Ð°Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð·Ð¾Ð²Ð»ÑÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ¸Ñ… Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ð°Ñ…, Ñ‡ÐµÐ¼ Ð¿Ñ€Ð¾ÑÑ‚Ð°Ñ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ ÑÑ…ÐµÐ¼Ð°. Ð¡Ð²ÑÐ·Ð°Ð½Ð° Ñ‚Ð°ÐºÐ°Ñ Ñ€Ð°Ð·Ð½Ð¸Ñ†Ð° Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ñ‡Ð°ÑÑ‚Ð¾Ñ‚ Ð² Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ð¾Ð¼ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼ Ð¿ÑƒÑ‚Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð¹ ÑÑ…ÐµÐ¼Ñ‹ (Ñƒ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¹ ÑÑ…ÐµÐ¼Ñ‹ Ð¾Ð½ Ð±Ð¾Ð»ÑŒÑˆÐµ).


## Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ clock gating Ð´Ð»Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¾Ð² Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð² Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð° Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ. ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ñ‚ÐµÑÑ‚Ð±ÐµÐ½Ñ‡ Ð¸ ÑƒÐ±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð´Ð¸Ð·Ð°Ð¹Ð½ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð°Ð²Ð¾Ðº.

## Ð£Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð»Ð¸ÑˆÐ½Ð¸Ðµ Ñ€ÐµÑÐµÑ‚Ñ‹ Ð² Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ðµ Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð° Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ. ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ñ‚ÐµÑÑ‚Ð±ÐµÐ½Ñ‡ Ð¸ ÑƒÐ±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð´Ð¸Ð·Ð°Ð¹Ð½ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð°Ð²Ð¾Ðº.
![alt text](pow5_pipelined_valid-1.png)

## ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ. Ð’ ÑÑ‚Ð¾Ð¼ Ñ„Ð°Ð¹Ð»Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¼Ð°ÑÑÐ¸Ð²Ð° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð¾Ð¼ 2x2. Ð£Ð²ÐµÐ»Ð¸Ñ‡ÑŒÑ‚Ðµ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð¼Ð°ÑÑÐ¸Ð²Ð° Ð´Ð¾ 2x3 (2 Ð² Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ, 3 Ð² ÑˆÐ¸Ñ€Ð¸Ð½Ñƒ, ÐºÐ°Ðº Ð² Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°Ñ…), Ð´Ð¾Ð±Ð°Ð²Ð¸Ð² ÐµÑ‰Ñ‘ Ð´Ð²Ð° ÑƒÐ·Ð»Ð°. ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ñ‚ÐµÑÑ‚Ð±ÐµÐ½Ñ‡ Ð¸ ÑƒÐ±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð´Ð¸Ð·Ð°Ð¹Ð½ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð°Ð²Ð¾Ðº.

## Ð”Ð¾Ð¿. Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÑƒÑ‚ÑŒ?
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€ Ð² Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð¹ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐµ?
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ð»Ð°Ñ‚ÐµÐ½Ñ‚Ð½Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð°?
* Ð˜Ð· Ñ‡ÐµÐ³Ð¾ ÑÐºÐ»Ð°Ð´Ñ‹Ð²Ð°ÐµÑ‚ÑÑ ÑÐ½ÐµÑ€Ð³Ð¾Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð»ÐµÐ½Ð¸Ðµ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð¹ Ð¼Ð¸ÐºÑ€Ð¾ÑÑ…ÐµÐ¼Ñ‹? ÐžÐ¿Ð¸ÑˆÐ¸Ñ‚Ðµ ÑÐ¾ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ðµ.
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Clock gating? ÐšÐ°ÐºÐ¸Ðµ Ð²Ð¸Ð´Ñ‹ Clock gating Ð²Ñ‹ Ð·Ð½Ð°ÐµÑ‚Ðµ?
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ free running Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹?
* Ð—Ð°Ñ‡ÐµÐ¼ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð»ÐµÐ·ÐµÐ½ Ñ„Ð»Ð°Ð³ Ð²Ð°Ð»Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ðµ?
* Ð§ÐµÐ¼ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÑÐ±Ñ€Ð¾Ñ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾?
* ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð² ASIC Ð»ÑƒÑ‡ÑˆÐµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹ Ð±ÐµÐ· Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ ÑÐ±Ñ€Ð¾ÑÐ° Ñ‚Ð°Ð¼, Ð³Ð´Ðµ ÑÑ‚Ð¾ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾?
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ ÑÐ¸ÑÑ‚Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð°ÑÑÐ¸Ð²? Ð—Ð°Ñ‡ÐµÐ¼ Ð¾Ð½ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ?
* Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ ÑƒÐ·ÐµÐ» ÑÐ¸ÑÑ‚Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¼Ð°ÑÑÐ¸Ð²Ð°? ÐšÐ°Ðº Ð¾Ð½ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚?
* ÐšÐ°Ðº Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ð¹ Ð² ÑÐ¸ÑÑ‚Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼ Ð¼Ð°ÑÑÐ¸Ð²Ðµ?

## ÐÐ±Ð±Ñ€Ð¸Ð²ÐµÐ°Ñ‚ÑƒÑ€Ñ‹
* WNS = Worst Negative Slack
* TNS = Total Negative Slack = sum of the negative slack paths
* WHS = Worst Hold Slack
* THS = Total Hold Slack = sum of the negative hold slack paths
> These values inform you how much the design is missing the timing requirements. 